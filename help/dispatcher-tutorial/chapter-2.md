---
title: 2장 - 이벤트 컨텐츠 조각 모델 정의
seo-title: AEM 컨텐츠 서비스 시작하기 - 2장 - 이벤트 컨텐츠 조각 모델 정의
description: AEM 헤드리스 자습서의 2장에서는 이벤트 생성을 위한 정규화된 데이터 구조 및 저작 인터페이스를 정의하는 데 사용되는 컨텐츠 조각 모델을 활성화하고 정의하는 데 사용됩니다.
seo-description: AEM 헤드리스 자습서의 2장에서는 이벤트 생성을 위한 정규화된 데이터 구조 및 저작 인터페이스를 정의하는 데 사용되는 컨텐츠 조각 모델을 활성화하고 정의하는 데 사용됩니다.
translation-type: tm+mt
source-git-commit: e99779b5d42bb9a3b258e2bbe815defde9d40bf7
workflow-type: tm+mt
source-wordcount: '1917'
ht-degree: 0%

---


# 제2장 기반시설

## 캐싱 인프라 설정

Adobe는 이 시리즈의 제1장에 게시 시스템과 디스패처의 기본적인 토폴로지를 도입했습니다. 게시 및 발송자 서버 세트는 예상되는 로드, 데이터 센터 토폴로지 및 원하는 페일오버 속성에 따라 다양한 변형으로 구성할 수 있습니다.

가장 일반적인 토픽을 스케치하고 이점과 단점을 설명할 것입니다. 물론 그 리스트는 포괄적일 수는 없다. 상상력만이 유일한 제한이다.

### &quot;기존&quot; 설정

초기에 잠재 방문자의 수는 작고 하드웨어는 비쌌으며 웹 서버는 오늘날의 비즈니스만큼 중요한 것으로 여겨지지 않았습니다. 두 개 이상의 게시 시스템 앞에 로드 밸런서 및 캐시를 제공하는 디스패처가 한 개 있었던 것이 일반적인 설정이었습니다. Dispatcher의 핵심에 있는 Apache 서버는 매우 안정적이며, 대부분의 설정에서 적절한 양의 요청을 제공할 수 있을 정도로 충분했습니다.

![&quot;기존&quot; 디스패처 설정 - 오늘날의 표준에서는 그다지 흔하지 않음](assets/chapter-2/legacy-dispatcher-setup.png)

*&quot;기존&quot; 디스패처 설정 - 오늘날의 표준에서는 그다지 흔하지 않습니다.*

<br> 

이 디스패처의 이름은 다음과 같습니다.기본적으로 요청을 전달합니다. 이러한 설정은 오늘날 요구되는 성능 및 안정성의 높은 요구를 충족할 수 없기 때문에 더 이상 일반적이지 않습니다.

### 다족 설정

요즈음은 약간 다른 위상이 더 일반적이다. 다중 다리 토폴로지는 게시 서버당 하나의 발송자를 가집니다. 전용(하드웨어) 로드 밸런서는 다음 두 개 이상의 다리에 요청을 전달하는 AEM 인프라 앞에 있습니다.

![최신 &quot;표준&quot; 발송자 설정 - 간편한 처리 및 유지 관리](assets/chapter-2/modern-standard-dispatcher-setup.png)

*최신 &quot;표준&quot; 발송자 설정 - 간편한 처리 및 유지 관리*

<br> 

이런 종류의 설정 이유는 다음과 같습니다

1. 웹 사이트의 트래픽이 과거에 비해 평균적으로 더 많으며 따라서 &quot;아파치 인프라&quot;를 확장할 필요가 있습니다.

2. &quot;기존&quot; 설정이 디스패처 수준에서 중복을 제공하지 않았습니다. Apache Server가 다운된 경우 전체 웹 사이트에 연결할 수 없었습니다.

3. Apache Server는 저렴합니다. 이러한 데이터는 오픈 소스를 기반으로 하며, 가상 데이터 센터가 있는 경우 매우 빠르게 프로비저닝될 수 있습니다.

4. 이 설정은 &quot;연속&quot; 또는 &quot;비틀기&quot; 업데이트 시나리오를 쉽게 만들 수 있도록 해줍니다. 게시 1에 새 소프트웨어 패키지를 설치하는 동안 Dispatcher 1을 종료하기만 하면 됩니다. 설치가 완료되고 내부 네트워크에서 충분히 연기 테스트를 거친 Publish 1이 있다면 Dispatcher 1의 캐시를 지우고 Dispatcher 2를 실행하여 Publish 2의 유지 관리를 수행할 때 다시 시작합니다.

5. 이 설정에서 캐시 무효화는 매우 쉽고 결정적입니다. 하나의 게시 시스템만 하나의 Dispatcher에 연결되어 있으므로 하나의 Dispatcher만 무효화할 수 있습니다. 무효화의 순서와 시기는 극히 작다.

### &quot;확장&quot; 설정

Apache Servers는 저렴하고 제공하기도 쉽습니다. 따라서 Apache Server는 이러한 수준을 좀 더 많은 수준으로 확대할 필요가 없습니다. 각 게시 서버 앞에 둘 이상의 Dispatcher가 없는 이유는 무엇입니까?

![&quot;확장&quot; 설정 - 일부 애플리케이션 영역과 제한 사항 및 경고가 있음](assets/chapter-2/scale-out-setup.png)

*&quot;확장&quot; 설정 - 일부 애플리케이션 영역과 제한 사항 및 경고가 있음*

<br> 

넌 할 수 있어! 그리고 그러한 설정에는 많은 유효한 응용 프로그램 시나리오가 있습니다. 그러나 고려해야 할 몇 가지 한계와 복잡성도 있습니다.

#### 무효화

각 게시 시스템은 다양한 디스패처에 연결되어 있으므로 컨텐츠를 변경하면 각 게시 시스템이 무효화되어야 합니다.

#### 유지 관리

Dispatcher와 Publish 시스템의 초기 구성이 좀 더 복잡하다는 것은 말할 필요도 없습니다. 그러나 또한 &quot;연속&quot; 출시를 위한 노력 또한 약간 더 높다는 것을 명심하십시오. AEM 시스템을 실행하는 동안 업데이트할 수 있으며 업데이트해야 합니다. 하지만 적극적인 응원 요청에 응하면서 그러지 않는 것이 현명하다. 일반적으로 게시 시스템의 일부만을 업데이트하려는 반면 다른 일부는 여전히 트래픽을 사용한 다음 테스트 후 다른 부분으로 전환하려고 합니다. 배포 프로세스에서 로드 밸런서에 액세스할 수 있는 경우, 여기에서 유지 관리 중인 서버에 대한 라우팅을 비활성화할 수 있습니다. 직접 액세스 권한이 없는 공유 로드 밸런서에 있는 경우 업데이트할 게시의 디스패처를 종료하는 것이 좋습니다. 더 많을수록 문을 닫아야 한다. 많은 수가 있고 자주 업데이트를 계획하고 있는 경우 일부 자동화가 권장됩니다. 자동화 툴이 없는 경우 크기 조절은 좋지 않습니다.

과거 프로젝트에서 로드 밸런서 자체에 직접 액세스하지 않고도 게시 시스템을 로드 밸런싱에서 제거하기 위해 다른 방법을 사용했습니다.

로드 밸런서는 일반적으로 서버가 작동 중이고 실행 중인지 확인하는 특정 페이지인 &quot;핑&quot;을 수행합니다. 사소한 선택은 보통 홈페이지를 ping하는 것이다. 그러나 ping을 사용하여 로드 밸런서에 트래픽 균형을 조정하지 않도록 신호를 보내려는 경우 다른 항목을 선택합니다. 본문 또는 http 응답 코드로 응답하도록 구성할 수 있는 전용 템플릿 `"up"` 또는 `"down"` 서블릿을 만듭니다. 해당 페이지의 응답은 디스패처에 캐시되어서는 안 되므로 게시 시스템에서 항상 새로 가져옵니다. 이제 이 템플릿이나 서블릿을 확인하도록 로드 밸런서를 구성하는 경우, 게시 &quot;작동 중지&quot;가 되도록 쉽게 허용할 수 있습니다. 로드 밸런싱에 포함되지 않고 업데이트할 수 있습니다.

#### 전 세계 배포

&quot;전 세계 배포&quot;는 각 게시 시스템 앞에 여러 디스패처가 있는 &quot;확장&quot; 설정이며, 이제 전 세계적으로 배포되어 고객과 더욱 가까워지고 더 나은 성능을 제공합니다. 물론 이 시나리오에는 중앙 부하 균형 조정기가 없고 DNS 및 지역-IP 기반 부하 균형 조정 체계가 없습니다.

>[!NOTE]
>
>실제로 이러한 접근 방식을 사용하는 CDN(Content Distribution Network)을 구축하고 있으므로 직접 CDN 솔루션을 구입하는 것이 아니라 선외의 CDN 솔루션을 구입하는 것을 고려해야 합니다. 사용자 지정 CDN을 빌드하고 유지 관리하는 것은 사소한 작업이 아닙니다.

#### 수평 비율

로컬 데이터 센터에서도 각 게시 시스템 앞에 여러 Dispatcher가 있으면 몇 가지 이점이 있는 &quot;확장&quot; 토폴로지가 있습니다. 높은 트래픽(및 높은 캐시 히트 속도)으로 인해 Apache 서버에서 성능 병목 현상이 나타나고 더 이상 하드웨어를 확장할 수 없는 경우(CPU, RAM 및 더 빠른 디스크 추가) Dispatcher를 추가하여 성능을 높일 수 있습니다. 이를 &quot;수평 크기 조절&quot;이라고 합니다. 하지만, 여기에는 제한이 있습니다. 특히 빈번하게 트래픽을 무효화할 때 그렇습니다. 다음 부분에 그 효과를 설명하겠습니다.

#### 확장 토폴로지 제한

프록시 서버를 추가하면 일반적으로 성능이 높아집니다. 그러나 서버를 추가하면 실제로 성능이 저하될 수 있는 시나리오가 있습니다. 어떻게? 뉴스 포털에서 매분 새로운 기사 및 페이지를 소개한다고 가정해 보십시오. 디스패처가 &quot;자동 무효화&quot;로 무효화를 무효화합니다.페이지가 게시될 때마다 동일한 사이트의 캐시에 있는 모든 페이지는 무효화됩니다. 이 기능은 유용한 기능입니다. 이 시리즈의 [1장에서](chapter-1.md) 다루었습니다만, 웹 사이트에서 자주 변경 사항이 있는 경우 캐시를 자주 무효화합니다. 게시 인스턴스당 하나의 발송자 인스턴스만 있는 경우 페이지를 요청하는 첫 번째 방문자가 해당 페이지의 재캐싱을 트리거합니다. 두 번째 방문자는 이미 캐시된 버전을 받습니다.

두 개의 Dispatcher가 있는 경우 두 번째 방문자는 페이지가 캐시되지 않을 확률이 50%이며, 그러면 해당 페이지가 다시 렌더링될 때 지연이 더 길어집니다. 게시 당 더 많은 Dispatcher를 사용하면 상황이 더 어려워집니다. 게시 서버는 각 Dispatcher에 대해 페이지를 개별적으로 다시 렌더링해야 하기 때문에 더 많은 로드를 수신합니다.

![캐시 플러시가 자주 발생하는 확장 시나리오의 성능 감소](assets/chapter-2/decreased-performance.png)

*캐시 플러시가 자주 발생하는 확장 시나리오의 성능 감소*

<br> 

#### 확대/축소 문제 해결

모든 Dispatcher에 대해 중앙 공유 저장소를 사용하거나 Apache 서버의 파일 시스템을 동기화하여 문제를 완화시킬 수 있습니다. 간단한 경험만 제공할 수 있지만 시스템의 복잡성이 가중되고 새로운 차원의 오류를 범할 수 있습니다.

NFS에서 몇 가지 실험을 수행했지만 컨텐츠 잠금으로 인해 NFS에서 엄청난 성능 문제를 야기하고 있습니다. 이는 실제로 전반적인 성과를 감소시켰습니다.

**결론** - 여러 디스패처 간에 공통 파일 시스템을 공유하는 것은 권장되는 방법이 아닙니다.

성능 문제가 발생하는 경우 게시 및 디스패처 역시 동일하게 확장하여 게시자 인스턴스의 최대 로드를 방지합니다. 게시/발송자 비율에는 황금률이 없으며, 이는 요청의 배포와 발행물 및 캐시 무효화의 빈도에 따라 매우 달라집니다.

방문자 경험의 지연에 대해서도 관심이 있는 경우 컨텐츠 전달 네트워크, 캐시 다시 페치, 선제 캐시 워밍, 이 시리즈의 [1장에 설명된 대로 유예 시간 설정 또는](chapter-1.md) 제3장에 [](chapter-3.md)대한 일부 고급 아이디어를 참조하십시오.

### &quot;연결됨&quot; 설정

&quot;연결됨&quot; 설정이 자주 표시됩니다.게시 인스턴스에는 전용 디스패처가 없지만 모든 디스패처가 모든 게시 시스템에 연결되어 있습니다.

![연결된 토폴로지:중복성 및 복잡성 증가](assets/chapter-2/cross-connected-setup.png)

<br> 

*연결된 토폴로지:중복성 및 복잡성 증가*

처음에는 비교적 적은 예산으로 보다 많은 중복성을 제공합니다. Apache 서버 중 하나가 다운된 경우에도 렌더링 작업을 수행하는 두 개의 Publish 시스템이 남아 있을 수 있습니다. 또한 게시 시스템 중 하나가 충돌하는 경우 캐시된 로드를 제공하는 두 명의 Dispatcher가 여전히 있습니다.

그러나 이는 대가가 따른다.

첫째, 유지보수를 위해 한쪽 다리를 꺼내는 것은 꽤 번거롭다. 사실, 이것은 이 계획이 설계된 것입니다.회복력이 있고 가능한 모든 방법을 통해 지속적으로 가동되고 실행되어야 합니다. 우리는 이 문제를 어떻게 처리하는지에 대한 복잡한 유지 계획을 보았습니다. Dispatcher 2를 먼저 재구성하여 크로스 연결을 제거합니다. Dispatcher 2를 다시 시작합니다. Dispatcher 1을 종료하고, 게시 1, ... 등을 업데이트합니다. 두 개 이상의 다리로 확대되는 경우 주의깊게 고려하십시오. 결론은, 그것은 사실 복잡성과 비용을 증가시키고, 인간 실수의 가공할 원천이라는 것입니다. 이를 자동화하는 것이 가장 좋습니다. 따라서 프로젝트 일정에 이 자동화 작업을 포함시킬 인재가 있다면 확인해 보십시오. 이를 통해 일부 하드웨어 비용을 절감할 수 있지만 IT 직원에게 두 배나 비용을 지출할 수 있습니다.

둘째, 로그인이 필요한 AEM에서 일부 사용자 응용 프로그램을 실행할 수 있습니다. 고정 세션을 사용하여 한 사용자가 동일한 AEM 인스턴스에서 항상 제공되므로 해당 인스턴스의 세션 상태를 유지할 수 있습니다. 이러한 교차 연결 설정을 통해 고정 세션이 로드 밸런서와 디스패처(Dispatcher)에서 제대로 작동하는지 확인해야 합니다. 불가능하지는 않습니다. 이러한 사실을 알고 추가 구성 및 테스트 시간을 추가해야 합니다. 이는 다시 말해 하드웨어를 저장하여 계획된 비용 절감 효과를 높일 수 있습니다.

### 결론

Adobe에서는 이 교차 연결 체계를 기본 옵션으로 사용하는 것을 권장하지 않습니다. 그러나 이 소프트웨어를 사용하려는 경우 위험 및 숨겨진 비용을 신중하게 평가하고 구성 자동화를 프로젝트의 일부로 포함시킬 계획입니다.

## 다음 단계

* [3 - 고급 캐싱 항목](chapter-3.md)
