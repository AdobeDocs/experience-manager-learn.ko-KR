---
title: 2장 - 이벤트 컨텐츠 조각 모델 정의
seo-title: AEM 컨텐츠 서비스 시작하기 - 2장 - 이벤트 컨텐츠 조각 모델 정의
description: AEM 헤드리스 자습서의 2장에서는 이벤트 생성을 위한 정규화된 데이터 구조 및 제작 인터페이스를 정의하는 데 사용되는 컨텐츠 조각 모델을 활성화 및 정의하는 방법에 대해 설명합니다.
seo-description: AEM 헤드리스 자습서의 2장에서는 이벤트 생성을 위한 정규화된 데이터 구조 및 제작 인터페이스를 정의하는 데 사용되는 컨텐츠 조각 모델을 활성화 및 정의하는 방법에 대해 설명합니다.
translation-type: tm+mt
source-git-commit: b040bdf97df39c45f175288608e965e5f0214703
workflow-type: tm+mt
source-wordcount: '1917'
ht-degree: 0%

---


# 제2장 기반시설

## 캐싱 인프라 설정

이 시리즈의 1장에 게시 시스템과 디스패처의 기본 토폴로지를 도입했습니다. 예상 로드, 데이터 센터 토폴로지 및 원하는 페일오버 속성에 따라 게시 및 발송자 서버 세트를 다양한 변형으로 구성할 수 있습니다.

가장 일반적인 토폴로지를 스케치하고 장점과 단점을 설명할 것입니다. 물론 그 리스트는 포괄적일 수는 없다. 상상력만 있다면 무리다.

### &quot;레거시&quot; 설정

초기에 잠재 방문자의 수는 작고 하드웨어는 비쌌으며 웹 서버는 오늘날 비즈니스와 같이 매우 중요한 것으로 여겨지지 않았습니다. 둘 이상의 게시 시스템 앞에 로드 밸런서 및 캐시로 사용되는 디스패처 하나가 있는 것이 일반적인 설정이었습니다. Dispatcher의 핵심에 있는 Apache 서버는 매우 안정적이며, 대부분의 설정에서 적절한 양의 요청을 제공할 수 있을 정도로 충분했습니다.

![&quot;기존&quot; 디스패처 설정 - 오늘날의 표준에서 매우 흔하지 않음](assets/chapter-2/legacy-dispatcher-setup.png)

*&quot;기존&quot; 디스패처 설정 - 오늘날의 표준에서 매우 흔하지 않음*

<br> 

다음은 디스패처의 이름을 받은 장소입니다.기본적으로 요청을 전달하는 것이었습니다. 이러한 설정은 오늘날 요구되는 높은 성능과 안정성 요구를 충족할 수 없기 때문에 더 이상 일반적이지 않습니다.

### 다족 설정

요즈음은 약간 다른 위상이 더 일반적이다. 다중 다리 토폴로지에는 게시 서버당 하나의 Dispatcher가 있습니다. 다음 두 개 이상의 다리에 요청을 전달하는 AEM 인프라 앞에 전용(하드웨어) 부하 균형 조정기가 있습니다.

![최신 &quot;표준&quot; 디스패처 설정 - 간편한 처리 및 유지 관리](assets/chapter-2/modern-standard-dispatcher-setup.png)

*최신 &quot;표준&quot; 디스패처 설정 - 간편한 처리 및 유지 관리*

<br> 

이런 종류의 설정 이유는 다음과 같습니다

1. 평균적으로 웹 사이트가 이전보다 훨씬 많은 트래픽을 제공합니다. 따라서 &quot;Apache infrastructure&quot;를 확장할 필요가 있습니다.

2. &quot;레거시&quot; 설정이 디스패처 수준에서 중복성을 제공하지 않았습니다. Apache Server가 다운된 경우 전체 웹 사이트에 연결할 수 없습니다.

3. Apache Server는 저렴합니다. 오픈 소스를 기반으로 하며 가상 데이터 센터가 있는 경우 매우 빠르게 프로비저닝할 수 있습니다.

4. 이 설정은 &quot;연속&quot; 또는 &quot;비틀기&quot; 업데이트 시나리오를 쉽게 제공합니다. 게시 1에 새 소프트웨어 패키지를 설치하는 동안 Dispatcher 1을 종료하기만 하면 됩니다. 설치가 완료되고 내부 네트워크에서 충분히 연기 테스트를 거친 게시 1이 있다면, 디스패처 1의 캐시를 정리하고 Dispatcher 2를 실행하여 게시 2의 유지 관리를 수행할 때 다시 시작합니다.

5. 이 설정에서 캐시 무효화는 매우 쉽고 결정적입니다. 하나의 게시 시스템만 하나의 Dispatcher에 연결되어 있으므로 무효화할 Dispatcher는 하나만 있습니다. 무효화의 순서와 타이밍은 별개다.

### &quot;확장&quot; 설정

Apache Server는 저렴하고 제공하기도 쉽습니다. 따라서 Apache Server는 이러한 수준의 확장을 좀 더 확대할 필요가 없습니다. 각 게시 서버 앞에 둘 이상의 Dispatcher가 없는 이유는 무엇입니까?

![&quot;확장&quot; 설정 - 일부 애플리케이션 영역뿐 아니라 제한 사항 및 주의해야 합니다.](assets/chapter-2/scale-out-setup.png)

*&quot;확장&quot; 설정 - 일부 애플리케이션 영역뿐 아니라 제한 사항 및 주의해야 합니다.*

<br> 

당신은 그것을 할 수 있습니다! 그리고 그러한 설정에 대한 많은 유효한 응용 프로그램 시나리오가 있습니다. 그러나 고려해야 할 몇 가지 한계와 복잡성도 있습니다.

#### 무효화

각 게시 시스템은 여러 Dispatcher에 연결되어 있으며 컨텐츠를 변경하면 각 게시 시스템이 무효화되어야 합니다.

#### 유지 관리

Dispatcher와 Publish 시스템의 초기 구성이 좀 더 복잡하다는 것은 말할 필요도 없습니다. 그러나 또한 &quot;연속&quot; 릴리스의 노력 또한 약간 높다는 것을 명심하십시오. AEM 시스템을 실행하는 동안 업데이트할 수 있으며 업데이트해야 합니다. 하지만 적극적인 응원 요청에 응하면서도 그렇게 하지 않는 것이 좋다. 일반적으로 게시 시스템의 일부만을 업데이트하려는 반면 다른 구성 요소는 여전히 트래픽을 제공하고 테스트 후에는 다른 부분으로 전환해야 합니다. 배포 프로세스에서 로드 밸런서에 액세스할 수 있는 경우 여기서 유지 관리 중인 서버에 대한 라우팅을 비활성화할 수 있습니다. 직접 액세스 권한이 없는 공유 부하 균형 조정기를 사용하는 경우 업데이트할 게시 디스패처를 종료하는 것이 좋습니다. 더 많을수록, 너는 더 문을 닫아야 할 것이다. 많은 수가 있고 자주 업데이트를 계획하고 있는 경우 일부 자동화가 권장됩니다. 자동화 도구가 없는 경우 크기 조절은 잘못된 생각입니다.

이전 프로젝트에서는 부하 균형 조정기 자체에 직접 액세스할 필요 없이 게시 시스템을 로드 밸런싱에서 제거하는 다른 방법을 사용했습니다.

로드 밸런서는 일반적으로 서버가 작동 중이고 실행 중인지 확인하는 특정 페이지인 &quot;핑&quot;을 수행합니다. 사소한 선택은 보통 홈페이지를 핑하는 것이다. 그러나 ping을 사용하여 로드 밸런서에 트래픽 균형을 맞추지 않도록 신호를 보내려면 다른 항목을 선택합니다. `"up"` 또는 `"down"`(본문 또는 http 응답 코드)로 응답하도록 구성할 수 있는 전용 템플릿 또는 서블릿을 만듭니다. 물론 해당 페이지의 응답은 디스패처에 캐시되어서는 안 됩니다. 따라서 항상 게시 시스템에서 새로 가져옵니다. 이제 로드 밸런서를 이 템플릿이나 서블릿을 확인하도록 구성한 경우 게시 &quot;표시&quot;가 다운된 것처럼 쉽게 허용할 수 있습니다. 로드 밸런싱에 포함되지 않으며 업데이트할 수 있습니다.

#### 전 세계 배포

&quot;전 세계 배포&quot;는 각 게시 시스템 앞에 여러 디스패처가 있는 &quot;확장&quot; 설정이며, 이제 전 세계에 배포되어 고객에게 보다 가까이 다가가고 더 나은 성능을 제공합니다. 물론 이 시나리오에는 중앙 부하 균형 조정기가 없지만 DNS 및 지역-IP 기반 부하 균형 조정 체계가 있습니다.

>[!NOTE]
>
>실제로, 이러한 접근 방식을 통해 일종의 CDN(Content Distribution Network)을 구축하고 있으므로 직접 CDN을 구축하지 않고도 바로 사용할 수 있는 CDN 솔루션을 구입하는 것을 고려해야 합니다. 사용자 지정 CDN을 빌드하고 유지 관리하는 것은 사소한 작업이 아닙니다.

#### 가로 비율 조정

로컬 데이터 센터에서도 각 게시 시스템 앞에 여러 Dispatcher가 있으면 몇 가지 장점이 있는 &quot;확장&quot; 토폴로지가 있습니다. 높은 트래픽(및 높은 캐시 히트 속도)으로 인해 Apache 서버에서 성능 병목 현상이 나타나고 더 이상 하드웨어를 확장할 수 없는 경우(CPU, RAM 및 빠른 디스크 추가) Dispatcher를 추가하면 성능을 높일 수 있습니다. 이를 &quot;수평 비율&quot;이라고 합니다. 하지만 이는 제한이 있습니다. 특히 빈번히 트래픽을 무효화할 때 그렇습니다. 다음 섹션에서 그 효과를 설명해 드리겠습니다.

#### 확장 토폴로지 제한

프록시 서버를 추가하면 일반적으로 성능이 높아집니다. 그러나 서버를 추가하면 실제로 성능이 저하될 수 있는 시나리오가 있습니다. 어떻게? 매분 새로운 기사 및 페이지를 소개하는 뉴스 포털이 있다고 생각해 보십시오. 디스패처가 &quot;자동 무효화&quot;로 무효화를 무효화합니다.페이지가 게시될 때마다 동일한 사이트의 캐시에 있는 모든 페이지는 무효화됩니다. 이 기능은 유용한 기능입니다. 이 기능은 이 시리즈의 [1장](chapter-1.md)에서 다루었습니다. 그러나 웹 사이트에서 자주 변경 사항이 있는 경우 캐시를 자주 무효화합니다. 게시 인스턴스당 하나의 디스패처만 있는 경우 페이지를 요청하는 첫 번째 방문자가 해당 페이지의 다시 캐시를 트리거합니다. 두 번째 방문자는 이미 캐시된 버전을 가져옵니다.

두 개의 Dispatcher가 있는 경우 두 번째 방문자는 페이지가 캐시되지 않을 확률이 50%이며 해당 페이지가 다시 렌더링될 때 지연이 더 길어집니다. 게시당 더 많은 Dispatcher를 사용하면 상황은 더욱 악화될 수 있습니다. 게시 서버는 각 Dispatcher에 대해 페이지를 개별적으로 다시 렌더링해야 하므로 더 많은 로드를 수신합니다.

![캐시 플러시가 자주 발생하는 확장 시나리오의 성능이 감소합니다.](assets/chapter-2/decreased-performance.png)

*캐시 플러시가 자주 발생하는 확장 시나리오의 성능이 감소합니다.*

<br> 

#### 비율 초과 문제 완화

모든 Dispatcher에 대해 중앙 공유 저장소를 사용하거나 Apache 서버의 파일 시스템을 동기화하여 문제를 완화시킬 수 있습니다. 간단한 직접 체험만 제공할 수 있지만 시스템의 복잡성을 가중시키고 새로운 차원의 오류를 도입할 수 있습니다.

NFS를 사용한 몇 가지 실험도 있었지만 컨텐츠 잠금으로 인해 NFS는 엄청난 성능 문제를 도입했습니다. 이는 실제로 전체 성과를 감소시켰습니다.

**결론**  - 여러 디스패처 간에 공통 파일 시스템을 공유하는 것은 권장되지 않습니다.

성능 문제가 발생하는 경우 게시자 인스턴스에서 최고의 로드를 방지하려면 게시 및 Dispatcher를 동일하게 확장합니다. 게시/디스패처 비율에는 황금률이 없습니다. 게시 및 캐시 무효화의 요청 배포 및 빈도에 따라 매우 달라집니다.

방문자 경험의 지연이 걱정되는 경우에도 이 시리즈의 [1장](chapter-1.md)에 설명된 대로 컨텐츠 전달 네트워크 사용, 캐시 다시 가져오기, 사전 캐시 온난화, 유예 시간 설정 등을 고려하거나 [Part 3](chapter-3.md)에 대한 일부 고급 아이디어를 참조하십시오.

### &quot;연결됨&quot; 설정

우리가 가끔 보았던 또 다른 설정은 &quot;연결됨&quot; 설정입니다.게시 인스턴스에는 전용 Dispatcher가 없지만 모든 Dispatcher가 모든 게시 시스템에 연결되어 있습니다.

![크로스 접속 토폴로지:중복성 및 복잡성 증가](assets/chapter-2/cross-connected-setup.png)

<br> 

*크로스 접속 토폴로지:중복성 및 복잡성 증가*

우선, 이것은 비교적 적은 예산에 대해 좀 더 많은 중복성을 제공합니다. Apache 서버 중 하나가 다운된 경우에도 렌더링 작업을 수행하는 2개의 Publish 시스템을 계속 사용할 수 있습니다. 또한 게시 시스템 중 하나가 충돌하는 경우 캐시된 로드를 제공하는 2명의 Dispatcher가 여전히 있습니다.

그러나 이는 가격입니다.

첫째, 유지보수를 위해 한쪽 다리를 꺼내는 것은 꽤 번거롭다. 사실, 이것은 이 계획이 설계된 것입니다.보다 회복력이 있고 가능한 모든 방법을 통해 활동할 수 있습니다. 우리는 이것을 어떻게 처리하는지에 대한 복잡한 유지 계획을 보았습니다. Dispatcher 2를 먼저 재구성하여 상호 연결을 제거합니다. Dispatcher 2를 다시 시작합니다. Dispatcher 1을 종료하고, 게시 1, ... 등을 업데이트합니다. 두 개 이상의 다리를 넘지 않도록 하려면 주의해서 생각해야 한다. 결론으로, 그것은 사실 복잡성과 비용을 증가시키고, 인간의 실수에 대한 가공할 원천입니다. 이를 자동화하는 것이 가장 좋습니다. 따라서 프로젝트 일정에 이 자동화 작업을 포함할 인력을 갖고 있다면 보다 효과적으로 확인할 수 있습니다. 하드웨어 비용을 절감할 수 있지만 IT 직원에게 두 배의 비용을 지출할 수 있습니다.

둘째, 로그인이 필요한 AEM에서 일부 사용자 응용 프로그램을 실행할 수 있습니다. 고정 세션을 사용하여 한 사용자가 동일한 AEM 인스턴스에서 항상 제공되도록 함으로써 해당 인스턴스에서 세션 상태를 유지할 수 있습니다. 이러한 교차 연결 설정이 있으면 고정 세션이 부하 균형 조정기와 디스패처 등에서 제대로 작동하는지 확인해야 합니다. 불가능하지는 않습니다. 그러나 이러한 사실을 알고 추가 구성 및 테스트 시간을 추가해야 합니다. 이는 다시 말해 하드웨어를 저장하여 계획된 비용 절감 효과를 높일 수 있습니다.

### 결론

Adobe에서는 이 교차 연결 체계를 기본 옵션으로 사용하는 것을 권장하지 않습니다. 그러나 이 제품을 사용하려는 경우 위험 요소와 숨겨진 비용을 신중하게 평가하고 구성 자동화를 프로젝트의 일부로 포함할 계획입니다.

## 다음 단계

* [3 - 고급 캐싱 항목](chapter-3.md)
